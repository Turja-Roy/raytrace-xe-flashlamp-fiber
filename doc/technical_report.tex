\input{preamble.tex}
\usepackage{bm}

\title{\large\bfseries
    A Modular Ray Tracing Framework for Optimizing VUV Flashlamp-to-Fiber Coupling Systems
}

\author{Turja Roy, Dr. Jonathan Abraham Asaadi, Dr. Varghese Anto Chirayath}
\affil{Department of Physics, University of Texas at Arlington, Arlington, TX 76019, USA}
\date{}

\begin{document}

\twocolumn[
\begin{@twocolumnfalse}
    \maketitle

    \begin{abstract}
        A comprehensive ray tracing methodology is presented for optimizing two-lens coupling systems for vacuum ultraviolet (VUV) flashlamp-to-fiber applications with realistic experimental constraints. The system couples 220 nm light from a Hamamatsu L7685 60W xenon flashlamp (3 mm arc) with E6611 cooling jacket into a 1 mm fiber core (NA = 0.22). The cooling jacket imposes critical geometric constraints: lens positioning constrained to z $\geq$ 27 mm and angular acceptance limited to 22.85$^\circ$, introducing 43\% geometric vignetting loss. Six optimization algorithms---grid search, Powell's method, differential evolution, Nelder-Mead simplex, dual annealing, and Bayesian optimization---are systematically compared using deterministic ray tracing with atmospheric absorption modeling. Systematic analysis identifies optimal configurations achieving coupling efficiencies up to 0.27 (argon) and 0.24 (air) at 220 nm, representing realistic performance under cooling jacket constraints. Powell's method and Nelder-Mead emerge as recommended algorithms for routine optimization, providing rapid convergence (~0.5--1 s per lens pair) and reliable performance. Combined atmospheric oxygen absorption and extended path lengths (optical system $L \approx$ 70 mm) create measurable medium-dependent effects at 220 nm: systematic comparison reveals 8--10\% coupling improvement in argon versus air for the LA4148+LA4022 configuration, closely matching the predicted 8.1\% atmospheric absorption loss and validating the attenuation model. This indicates air propagation is viable when the performance penalty is acceptable, while argon maximizes coupling. Wavelength dependence analysis (150--300 nm) establishes chromatic performance characteristics and validates wavelength-dependent material modeling. The framework provides both a practical design tool incorporating realistic experimental constraints and methodological insights for non-convex optical optimization problems.
    \end{abstract}
    \vspace{0.5cm}
\end{@twocolumnfalse}
]

\section{Introduction}

Efficient coupling of vacuum ultraviolet light from incoherent sources into optical fibers presents significant challenges due to the inherent divergence of arc lamp sources and the limited acceptance angles of fibers \cite{hecht2017}. The Hamamatsu L7685 60W xenon flash lamp provides a compact broadband source (190--2000 nm) suitable for liquid argon purity monitoring applications in the VUV/DUV range. This work focuses on optimizing coupling at the design wavelength of 220 nm, where fiber-optic delivery enables remote sensing and flexible optical system configurations in cryogenic environments.

The design of compact coupling optics requires balancing multiple objectives: maximizing coupling efficiency, minimizing physical length, and maintaining practical manufacturability with commercially available optical components. Traditional lens design approaches often rely on paraxial approximations or specialized optical design software \cite{greivenkamp2004}. However, the large numerical aperture and wide divergence angles in Xe flashlamp systems necessitate full ray tracing to accurately predict system performance.

In this work, a stratified ray tracing framework is developed that incorporates realistic source geometry, lens specifications, fiber acceptance criteria, and atmospheric absorption effects (O$_2$, N$_2$, and H$_2$O). The design problem is formulated as a multi-objective optimization task, and six distinct optimization algorithms are systematically compared to identify lens positioning that maximizes performance. This approach provides both a practical design tool and insights into the efficacy of various optimization strategies for optical systems with complex, non-convex objective functions characterized by multiple local optima and discrete ray-counting mechanics that preclude
 analytical gradient computation.

\section{System Description}

\subsection{Optical Configuration}

The optical system comprises a Hamamatsu L7685 60W xenon flash lamp \cite{hamamatsu} with Hamamatsu E6611 cooling jacket, two fused silica lenses, and a multi-mode optical fiber \cite{accuglass} arranged along a common optical axis. The lamp emits broadband radiation (190--2000 nm) from a compact 3.0 mm diameter arc; this work analyzes coupling performance at $\lambda =$ 150--300 nm. 

The lamp assembly includes a protective Single Crystal Sapphire Glass window (14.3 mm diameter) positioned 8.7 mm from the arc. Critically, the Hamamatsu E6611 cooling jacket surrounds the lamp housing and constrains the optical aperture through its M23 threaded exit port (inner diameter 23 mm) located approximately 26 mm from the arc center. This cooling jacket imposes both geometric constraints on lens positioning and vignetting losses on the emitted light, as detailed in Section 2.2. The two-lens relay system is positioned after the cooling jacket exit to collect and refocus the divergent light into the fiber.

% FIGURE 1: Lamp and Cooling Jacket Dimensional Outline
\begin{figure}[htpb]
    \centering
    \begin{subfigure}{0.45\textwidth}
        \centering
        \includegraphics[width=0.80\textwidth]{L7685-Dimensional-Outline.png}
        \caption{}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \centering
        \includegraphics[width=0.80\textwidth]{E6611-Cooling-Jacket.png}
        \caption{}
    \end{subfigure}
    \caption{Dimensional Outline of (a) Hamamatsu L7685 Xenon Flash Lamp and (b) Hamamatsu E6611 Cooling Jacket (Unit: mm)}
    \label{fig:lamp_outline}
\end{figure}

\subsection{Source Characteristics}

The xenon arc source exhibits a spatially extended emission profile with angular divergence constrained by the cooling jacket geometry. The source is modeled as emitting rays from a circular disk of radius $r_{\text{arc}} = 1.5$ mm with angular distribution characterized by a maximum half-angle $\theta_{\max} = 22.85^\circ$, determined by the cooling jacket aperture geometry: $\theta_{\max} = \arctan(r_{\text{jacket}}/z_{\text{jacket}}) = \arctan(11.5\text{ mm}/26\text{ mm})$, where $r_{\text{jacket}} = 11.5$ mm is the cooling jacket M23 thread radius and $z_{\text{jacket}} = 26$ mm is the distance from arc to jacket exit.

This coherent beam model assumes that rays originating at radius $r$ from the arc center propagate with half-angle $\theta(r) = \theta_{\max} \cdot r/r_{\text{arc}}$, representing the geometric constraint imposed by the cooling jacket aperture. The cooling jacket introduces a geometric loss factor of approximately 0.43 (43\% vignetting loss, 57\% transmission) due to solid angle reduction compared to an unobstructed hemispherical emission. This vignetting represents a fundamental constraint on system performance that cannot be eliminated through optical design optimization.

\subsection{Fiber Specifications}

The target optical fiber features a 1.0 mm core diameter with numerical aperture NA $= 0.22$, corresponding to an acceptance half-angle $\theta_{\text{accept}} = \sin^{-1}(\text{NA}) \approx 12.4^\circ$. Successful coupling requires that incident rays satisfy both spatial (impinge within the core area) and angular (arrive within the acceptance cone) criteria simultaneously.

\subsection{Lens Properties}

All lenses are fabricated from UV-grade fused silica with refractive index $n = 1.528$ at $\lambda = 220$ nm, calculated using the Sellmeier dispersion formula \cite{malitson1965}. Plano-convex, bi-convex, and aspheric lens geometries are tested for their favorable aberration characteristics and commercial availability. Specifications including focal length $f$, radius of curvature $R$, center thickness $t_c$, edge thickness $t_e$, and clear aperture diameter are drawn from manufacturer catalogs \cite{thorlabs,edmundoptics}.

\section{Computational Methods}

\subsection{Stratified Ray Sampling}

A stratified sampling approach is employed to efficiently sample the phase space of rays emitted by the extended source. For each simulation, $N = 1000$ to 2000 rays are generated with origins uniformly distributed over the arc area and directions following the prescribed angular distribution.

Radial positions are sampled using inverse transform sampling to ensure uniform spatial distribution:
\begin{align}
r_i &= \sqrt{U_i} \cdot r_{\text{arc}}, \quad U_i \sim \mathcal{U}(0,1) \\
\phi_i &= \frac{2\pi i}{N}
\end{align}
where $\mathcal{U}(0,1)$ denotes the uniform distribution. Azimuthal angles $\phi_i$ are uniformly spaced to provide comprehensive angular coverage. The Cartesian coordinates of source points are:
\begin{equation}
\mathbf{o}_i = (r_i \cos\phi_i, \, r_i \sin\phi_i, \, 0)
\end{equation}

The ray propagation half-angle scales linearly with radial position:
\begin{equation}
\theta_i = \theta_{\max} \cdot \frac{r_i}{r_{\text{arc}}}
\end{equation}
resulting in direction vectors:
\begin{equation}
\mathbf{d}_i = (\sin\theta_i \cos\phi_i, \, \sin\theta_i \sin\phi_i, \, \cos\theta_i)
\end{equation}
All direction vectors are normalized to unit length.

\subsection{Geometric Ray Tracing}

Ray propagation through the optical system is computed using vector-based geometric optics without paraxial approximations \cite{glassner1989}. This approach accurately accounts for large ray angles, finite apertures, and aberrations.

\subsubsection{Ray-Surface Intersection}

For a spherical surface of radius $R$ centered at $\mathbf{c}$, the intersection of ray $\mathbf{p}(t) = \mathbf{o} + t\mathbf{d}$ is found by solving:
\begin{equation}
\|\mathbf{o} + t\mathbf{d} - \mathbf{c}\|^2 = R^2
\end{equation}
Expanding yields the quadratic equation:
\begin{align}
a &= 1 \\
b &= 2(\mathbf{o} - \mathbf{c}) \cdot \mathbf{d} \\
c &= \|\mathbf{o} - \mathbf{c}\|^2 - R^2 \\
\Delta &= b^2 - 4c
\end{align}
The nearest positive intersection occurs at:
\begin{equation}
t = \frac{-b - \sqrt{\Delta}}{2}, \quad \Delta \geq 0
\end{equation}
Rays missing the surface ($\Delta < 0$) or blocked by the aperture ($\sqrt{p_x^2 + p_y^2} > r_{\text{ap}}$) are rejected.

\subsubsection{Vector Refraction}

At each refractive interface, Snell's law is applied in vector form. For incident ray $\mathbf{d}_{\text{in}}$, surface normal $\mathbf{n}$ (pointing into the incident medium), and refractive indices $n_1$ and $n_2$:
\begin{align}
\eta &= \frac{n_1}{n_2} \\
\cos\theta_i &= -\mathbf{n} \cdot \mathbf{d}_{\text{in}} \\
k &= 1 - \eta^2(1 - \cos^2\theta_i)
\end{align}
Total internal reflection occurs when $k < 0$. Otherwise, the refracted ray is:
\begin{equation}
\mathbf{d}_{\text{out}} = \eta \mathbf{d}_{\text{in}} + (\eta \cos\theta_i - \sqrt{k})\mathbf{n}
\end{equation}
For spherical surfaces, the outward normal is $\mathbf{n} = (\mathbf{p} - \mathbf{c})/R$. For planar surfaces, $\mathbf{n} = (0, 0, -1)$. Bi-convex lenses have two spherical surfaces, while aspheric lenses require polynomial surface normals computed from their aspheric profile.

% FIGURE 2: Ray Tracing Visualization (2D System Diagram)
\begin{figure}[htpb]
    \centering
    \includegraphics[width=\columnwidth]{C-0.2690_L1-LA4148_L2-LA4022_2d.png}
    \caption{Ray trace diagram showing the optimal optical system layout at 220 nm in argon: xenon arc source (left), two plano-convex lenses (LA4148 and LA4022, $f_1 = 50.2$ mm, $f_2 = 60$ mm), and fiber entrance (right). Ray paths illustrate beam collection and refocusing through the two-lens relay system under cooling jacket constraints (first lens positioned at z $\geq$ 27 mm). Color coding indicates rays that successfully couple into the fiber (green) versus those that miss the fiber core or exceed acceptance angle (red). This configuration achieves coupling efficiency $\eta = 0.27$ with system length $L \approx 70$ mm.}
    \label{fig:raytrace_2d}
\end{figure}

\subsubsection{Lens Propagation}

After refraction at the front surface, the ray propagates through the lens material to the back surface. The exit point is determined by tracing the refracted ray to its intersection with the back surface geometry:

\textbf{Plano-convex lenses:} If the back surface is planar (located at $z = z_{\text{back}}$), the intersection is computed as:
\begin{equation}
\mathbf{o}_{\text{back}} = \mathbf{p}_{\text{front}} + \frac{z_{\text{back}} - p_{\text{front},z}}{d_{\text{refracted},z}} \mathbf{d}_{\text{refracted}}
\end{equation}

\textbf{Bi-convex lenses:} Both surfaces are spherical. The back surface has center of curvature $\mathbf{c}_{\text{back}}$ and radius $R_{\text{back}}$. The ray-sphere intersection equation (Eq.~5--8) is applied with the refracted ray origin $\mathbf{o} = \mathbf{p}_{\text{front}}$ and direction $\mathbf{d} = \mathbf{d}_{\text{refracted}}$.

\textbf{Aspheric lenses:} The back surface may be planar, spherical convex, or spherical concave. The appropriate intersection method is selected based on the back surface type. In the current implementation, aspheric front surfaces are approximated as spherical with base radius $R_{\text{front}}$ (conic constant $k=0$); full aspheric ray tracing with polynomial surface equations is reserved for future enhancement when complete aspheric coefficients become available.

All methods compute the actual optical path through the lens based on the refracted ray direction and lens geometry, accounting for ray angle and radial position effects.

\subsection{Fiber Coupling Analysis}

After traversing both lenses, rays propagate to the fiber face located at $z = z_{\text{fiber}}$. The intersection point is computed as:
\begin{equation}
\mathbf{p}_{\text{fiber}} = \mathbf{o}_2 + \frac{z_{\text{fiber}} - o_{2z}}{d_{2z}} \mathbf{d}_2
\end{equation}
where $\mathbf{o}_2$ and $\mathbf{d}_2$ are the ray origin and direction after the second lens.

A ray successfully couples into the fiber if:
\begin{enumerate}[leftmargin=*]
    \item \textit{Spatial criterion}: $\sqrt{p_x^2 + p_y^2} \leq r_{\text{core}} = 0.5$ mm
    \item \textit{Angular criterion}: $\theta = \arccos(|d_{2z}|/\|\mathbf{d}_2\|) \leq \theta_{\text{accept}} = 12.4^\circ$
\end{enumerate}
The coupling efficiency is:
\begin{equation}
\eta_{\text{coupling}} = \frac{N_{\text{accepted}}}{N_{\text{total}}}
\end{equation}

\section{Optimization Framework}

\subsection{Problem Formulation}

The optical design task is formulated as a constrained multi-objective optimization problem. Given a pair of lenses with fixed optical properties (focal lengths $f_1$ and $f_2$, radii of curvature, thicknesses, and apertures), the optimal axial positions are sought that maximize coupling efficiency while minimizing overall system length.

\subsubsection{Design Variables}

The optimization space comprises three continuous parameters:
\begin{itemize}[leftmargin=*]
    \item $z_1$: axial position of the first lens vertex (mm)
    \item $z_2$: axial position of the second lens vertex (mm)  
    \item $z_{\text{fiber}}$: axial position of the fiber face (mm)
\end{itemize}

Physical constraints ensure feasible configurations:
\begin{align}
z_1 &\geq z_{\text{jacket}} + \Delta z_{\text{min}} = 27\text{ mm} \\
z_2 &> z_1 + 0.1\text{ mm} \\
z_{\text{fiber}} &\approx z_2 + f_2
\end{align}
where $z_{\text{jacket}} = 26$ mm is the cooling jacket exit position, $\Delta z_{\text{min}} = 1$ mm provides clearance, and the fiber position is typically placed one focal length beyond the second lens as a starting approximation. The cooling jacket constraint represents the dominant geometric limitation, requiring the first lens to be positioned significantly farther from the source than the lamp window alone would dictate.

\subsubsection{Objective Function}

A weighted-sum scalarization is employed to combine coupling efficiency maximization and length minimization:
\begin{equation}
\min_{z_1,z_2} f(z_1, z_2) = \alpha(1 - \eta_{\text{coupling}}) + (1-\alpha)\frac{z_{\text{fiber}}}{L_{\text{norm}}}
\end{equation}
where $\alpha \in [0,1]$ is the preference weight (default $\alpha = 0.7$ prioritizes coupling), and $L_{\text{norm}} = 80$ mm is a normalization length. This formulation converts both objectives to minimization with comparable scales.

Each evaluation of $f(z_1, z_2)$ requires complete ray tracing of $N$ rays through the system, making the objective function computationally expensive and non-differentiable due to discrete ray counting and aperture clipping.

\subsection{Optimization Algorithms}

Six optimization methods are implemented and compared, representing different algorithmic paradigms: exhaustive search, local gradient-free methods, and global stochastic approaches.

\subsubsection{Grid Search}

An exhaustive two-stage search, implemented from scratch, establishes a performance baseline. In the coarse stage, a $7 \times 7$ grid samples the parameter space with bounds determined by cooling jacket clearance and lens focal lengths:
\begin{align}
z_1 &\in [27, \, \max(32, 1.5f_1)] \\
z_2 &\in [z_1 + 0.5f_2, \, z_1 + 2.5f_2]
\end{align}
The lower bound on $z_1$ reflects the cooling jacket constraint ($z_{\text{jacket}} + \Delta z_{\text{min}} = 27$ mm). The best coarse solution undergoes local refinement via a $9 \times 9$ grid spanning $\pm 2\Delta$ around the coarse optimum, where $\Delta$ is the coarse grid spacing. Total evaluations: 130 per lens pair.

Implementation: \path{scripts/optimization/grid_search.py}. Uses 500 rays per evaluation to balance accuracy and speed. Fiber position is fixed at $z_{\text{fiber}} = z_2 + f_2$ for each $(z_1, z_2)$ pair.

\subsubsection{Powell's Method}

Powell's conjugate direction method \cite{powell1964} performs derivative-free local optimization by iteratively minimizing along coordinate axes and constructed conjugate directions. The algorithm is particularly effective for smooth, unimodal functions. 

Implementation uses SciPy's \texttt{optimize.minimize} with method \texttt{`Powell'} \cite{scipy}. Parameters: 200 maximum iterations, position tolerance $\Delta x = 0.01$ mm, function tolerance $\Delta f = 0.001$. Initial guess: $z_1^{(0)} = \max(27, 0.8f_1)$, $z_2^{(0)} = z_1^{(0)} + 1.2f_2$, where the lower bound reflects the cooling jacket constraint. Uses 1000 rays per evaluation for higher precision than grid search.

Module: \path{scripts/optimization/powell.py}. Typically converges in 30--50 function evaluations.

\subsubsection{Nelder-Mead Simplex}

The Nelder-Mead algorithm \cite{nelder1965} maintains a simplex of $n+1$ points in $n$-dimensional space, updating via geometric transformations (reflection, expansion, contraction, shrinkage). It is robust to function noise and requires no derivatives.

Implementation uses SciPy's \texttt{optimize.minimize} with method \texttt{`Nelder-Mead'} \cite{scipy}. Parameters: 200 maximum iterations, position tolerance 0.01 mm, function tolerance 0.001. Same initialization as Powell's method. Uses 1000 rays per evaluation.

Module: \path{scripts/optimization/nelder_mead.py}. Fastest local method, typically converging in 20--40 evaluations.

\subsubsection{Differential Evolution}

Differential evolution \cite{storn1997} is a population-based global optimizer using evolutionary strategies. At each generation, trial vectors are created via:
\begin{equation}
\mathbf{x}_{\text{trial}} = \mathbf{x}_r + F(\mathbf{x}_a - \mathbf{x}_b)
\end{equation}
where $\mathbf{x}_r$, $\mathbf{x}_a$, $\mathbf{x}_b$ are randomly selected population members and $F$ is the mutation factor. Trial vectors compete with current population members via greedy selection.

Implementation uses SciPy's \path{optimize.differential_evolution} \cite{scipy}. Parameters: population size 10, maximum 50 iterations, tolerance 0.001. Bounds as specified for grid search. Uses 1000 rays per evaluation.

Module: \path{scripts/optimization/differential_evolution.py}. Provides thorough global exploration when robustness is critical. Typical evaluations: 60--100.

\subsubsection{Dual Annealing}

Dual annealing \cite{xiang2013,xiang2000} combines classical simulated annealing with local search to escape local minima. The algorithm accepts worse solutions probabilistically according to the Boltzmann criterion:
\begin{equation}
P_{\text{accept}} = \exp\left(-\frac{\Delta f}{k_B T}\right)
\end{equation}
where $T$ decreases according to an adaptive cooling schedule.

Implementation uses SciPy's \path{optimize.dual_annealing} \cite{scipy}. Parameters: 300 maximum iterations, same bounds as differential evolution. Uses 1000 rays per evaluation. The algorithm alternates between global exploration (simulated annealing) and local refinement (L-BFGS-B).

Module: \path{scripts/optimization/dual_annealing.py}. Effective for highly multi-modal landscapes. Typical evaluations: 80--120.

\subsubsection{Bayesian Optimization}

Bayesian optimization \cite{mockus1978,jones1998} builds a Gaussian process (GP) surrogate model of the objective function and selects evaluation points by maximizing an acquisition function, typically expected improvement (EI):
\begin{equation}
\text{EI}(\mathbf{x}) = \mathbb{E}[\max(f_{\text{best}} - f(\mathbf{x}), 0)]
\end{equation}
This approach is sample-efficient, making it suitable for expensive objectives. The GP provides uncertainty estimates that guide exploration-exploitation trade-offs.

Implementation uses scikit-optimize's \texttt{gp\_minimize} \cite{skopt}. Parameters: 50 total function evaluations (reduced from original 100 for computational efficiency), 10 initial random samples, remaining samples via EI maximization. Uses 1000 rays per evaluation. Requires additional package: \texttt{pip install scikit-optimize}.

Module: \path{scripts/optimization/bayesian.py}. Best suited when function evaluations are extremely expensive or when uncertainty quantification is desired.

\section{Material Properties}

The refractive index of fused silica at VUV wavelengths is calculated using the Sellmeier dispersion equation \cite{malitson1965}:
\begin{equation}
n^2(\lambda) = 1 + \sum_{i=1}^{3} \frac{B_i\lambda^2}{\lambda^2 - C_i}
\end{equation}
with Malitson coefficients:
\begin{align*}
B_1 &= 0.6961663, \quad C_1 = (0.0684043)^2 \\
B_2 &= 0.4079426, \quad C_2 = (0.1162414)^2 \\
B_3 &= 0.8974794, \quad C_3 = (9.896161)^2
\end{align*}
where wavelength $\lambda$ is expressed in micrometers. At the operating wavelength $\lambda = 0.22$ $\mu$m (220 nm), this yields $n = 1.528$.

\section{Atmospheric Attenuation}

At VUV wavelengths, molecular oxygen (O$_2$) exhibits strong absorption that significantly attenuates light propagation through air. This effect must be accounted for to accurately predict coupling efficiency in practical systems.

\subsection{Beer-Lambert Absorption}

The transmission of light through an absorbing medium follows the Beer-Lambert law:
\begin{equation}
T = \exp(-\alpha d)
\end{equation}
where $T$ is the fractional transmission, $\alpha$ is the wavelength-dependent attenuation coefficient (mm$^{-1}$), and $d$ is the propagation distance (mm).

The attenuation coefficient for a multi-component gas mixture is:
\begin{equation}
\alpha(\lambda) = \sum_i \sigma_i(\lambda) n_i
\end{equation}
where $\sigma_i(\lambda)$ and $n_i$ denote the absorption cross-section and number density of species $i$, in units of \unit{cm^2} and \unit{molecules\per cm^3}, respectively.

\subsection{O$_2$ Absorption Cross-Section}

At 220 nm, oxygen absorption dominates atmospheric attenuation. The cross-section is computed using the Minschwaner parameterization \cite{minschwaner1992}, valid for 175--242 nm:
\begin{equation}
\log_{10} \sigma_{\text{O}_2}(\lambda) = a_0 + a_1\lambda + a_2\lambda^2 + a_3\lambda^3 + a_4\lambda^4 + a_5\lambda^5 - 16
\end{equation}
with coefficients:
\begin{align*}
a_0 &= -4.4011 \times 10^1, \quad a_1 = 6.2067 \times 10^{-1} \\
a_2 &= -3.5668 \times 10^{-3}, \quad a_3 = 9.5745 \times 10^{-6} \\
a_4 &= -1.2775 \times 10^{-8}, \quad a_5 = 6.6574 \times 10^{-12}
\end{align*}
where $\lambda$ is in nanometers and $\sigma$ is in cm$^2$. At 220 nm, this yields $\sigma_{\text{O}_2} = 1.15 \times 10^{-20}$ cm$^2$.

\subsection{Number Density Calculation}

Number densities are computed from the ideal gas law:
\begin{equation}
n = \frac{P}{k_B T}
\end{equation}
where $P$ is pressure, $T$ is temperature, and $k_B = 1.381 \times 10^{-23}$ J/K is Boltzmann's constant. At standard conditions ($P = 1$ atm, $T = 293$ K), the total number density is $n_{\text{total}} = 2.50 \times 10^{19}$ molecules/cm$^3$.

For dry air composition:
\begin{align}
n_{\text{O}_2} &= 0.21 \times n_{\text{total}} = 5.25 \times 10^{18} \text{ cm}^{-3} \\
n_{\text{N}_2} &= 0.78 \times n_{\text{total}} = 1.95 \times 10^{19} \text{ cm}^{-3}
\end{align}
N$_2$ absorption is negligible above 100 nm. Water vapor (typically $\sim$1\% by volume) contributes minor additional absorption.

\subsection{Attenuation Implementation}

The attenuation coefficient for air at 220 nm is:
\begin{equation}
\alpha_{\text{air}} = \sigma_{\text{O}_2} n_{\text{O}_2} \approx 0.060 \text{ mm}^{-1}
\end{equation}

Each ray's intensity is attenuated according to its cumulative path length $d_{\text{total}}$ through air:
\begin{equation}
I_{\text{fiber}} = I_0 \exp(-\alpha_{\text{air}} d_{\text{total}})
\end{equation}
where $d_{\text{total}}$ includes propagation from arc to window, inter-lens distances, and lens-to-fiber distance. For typical system lengths of 30--100 mm, transmission ranges from 16\% to 0.25\%, representing substantial loss.

This absorption model is implemented in \path{scripts/calcs.py} using cross-section data from \path{scripts/hitran_data.py}.

\section{Model Assumptions and Validity}

The ray tracing model incorporates several simplifying assumptions:

\begin{enumerate}[leftmargin=*]
    \item \textit{Geometric optics regime}: The wavelength ($\lambda = 220$ nm) is negligible compared to all physical dimensions (apertures $\sim$ 1-25 mm), validating the ray approximation and neglecting diffraction effects.
    
    \item \textit{Simplified angular distribution}: The angular distribution is deterministic with respect to radial position. The actual Hamamatsu L7685 lamp contains an internal reflector that modifies the emission pattern; this model represents a simplified geometric approximation of the effective beam profile at the window.
    
    \item \textit{Perfect optical surfaces}: Surface roughness, figure errors, and manufacturing imperfections are neglected. Real VUV optics may deviate from ideal spherical and planar surfaces.
    
    \item \textit{Atmospheric absorption included; surface losses neglected}: Molecular absorption (primarily O$_2$ at 220 nm) is modeled using the Beer-Lambert law with Minschwaner cross-sections. However, Fresnel reflections at each air-glass interface (approximately 4-5\% per surface at 220 nm, totaling $\sim$20\% for 4 surfaces) and bulk absorption in fused silica are not included. Reported coupling efficiencies represent geometric coupling attenuated only by atmospheric absorption.
    
    \item \textit{Monochromatic light}: Chromatic aberration is absent. Real flashlamp spectra span broad wavelength ranges.
    
    \item \textit{Perfect alignment}: Lens decentration, tilt, and fiber misalignment errors are assumed zero. Practical systems require careful alignment procedures.
    
    \item \textit{Uniform fiber acceptance}: The numerical aperture is assumed constant across the core. Variations due to fiber manufacturing tolerances are ignored.
\end{enumerate}

These assumptions are appropriate for design-stage performance prediction. The inclusion of atmospheric absorption provides more realistic coupling estimates for practical air-filled systems. Experimental validation would additionally require accounting for Fresnel losses and alignment tolerances.

\section{Results}

\subsection{Implementation Architecture}

The optimization framework is implemented as a modular Python system with separate modules for each algorithm located in \path{scripts/optimization/}. A unified runner interface (\path{optimization_runner.py}) provides consistent access to all methods through a common API. The command-line interface (\path{raytrace.py}) provides six operational modes:

\begin{itemize}[leftmargin=*]
    \item \texttt{particular}: Optimize a specific lens pair with chosen algorithm
    \item \texttt{compare}: Evaluate all six algorithms on a single lens pair
    \item \texttt{select}: Optimize 3,876 strategically chosen lens combinations (68 L1 candidates $\times$ 57 L2 candidates)
    \item \texttt{select-ext}: Extended selection mode with refined lens candidate filters and coupling thresholds
    \item \texttt{combine}: Exhaustive optimization of all 24,336 lens combinations (156 $\times$ 156)
    \item \texttt{analyze}: Re-optimize previously identified high-coupling configurations with all methods
    \item \texttt{wavelength-analyze}: Evaluate coupling efficiency across wavelength ranges for specific configurations
\end{itemize}

Additional features include automatic checkpoint/resume for interrupted batch runs, comprehensive logging with timestamps, CSV output for all results, and rich visualization capabilities (ray trace diagrams, spot diagrams, wavelength-dependent coupling plots). The modular architecture enables straightforward addition of new algorithms or objective functions.

\subsection{Performance Comparison}

Table~\ref{tab:optimization_comparison} presents a systematic comparison of all six optimization methods applied to the highest-performing lens pair (LA4148 + LA4022, $f_1 = 50.2$ mm, $f_2 = 60$ mm) at 220 nm. Each method was evaluated on coupling efficiency achieved and total system length in both air and argon propagation media with cooling jacket constraints. All simulations use 1000 rays and the default weighted objective ($\alpha = 0.7$). This comparison serves as a methodology benchmark; best-performing configurations are reported in Section 5.3.

\begin{table}[h]
\centering
\caption{Optimization Algorithm Performance Comparison at 220 nm (lens pair: LA4148 + LA4022)}
\label{tab:optimization_comparison}
\small
\begin{tabular}{lcccc}
\hline
\textbf{Method} & \textbf{Air $\bm{\eta}$} & \textbf{Air $\bm{L}$} & \textbf{Argon $\bm{\eta}$} & \textbf{Argon $\bm{L}$} \\
 & & \textbf{(mm)} & & \textbf{(mm)} \\
\hline
Diff. Evol. & 0.24 & 70.3 & \textbf{0.27} & 70.9 \\
Dual Anneal. & 0.24 & 69.5 & 0.26 & 70.3 \\
Nelder-Mead & 0.24 & 69.6 & 0.26 & 69.6 \\
Powell & 0.24 & 70.4 & 0.26 & 70.2 \\
Grid Search & 0.17 & 129.4 & 0.21 & 129.8 \\
Bayesian & --- & --- & --- & --- \\
\hline
\end{tabular}
\end{table}

Differential evolution emerges as the most effective method across both media, achieving the highest coupling in argon (0.27) and competitive air performance (0.24) with moderate computational cost (~8-10 seconds) and compact system lengths (70.3--70.9 mm). Dual annealing, Nelder-Mead, and Powell's method provide excellent balance with consistent performance across both media (argon: 0.26, air: 0.24) and sub-second runtime (~0.5-1 second for Powell and Nelder-Mead). Notably, grid search performs significantly worse across both media (air: 0.17, argon: 0.21), converging to an impractically long configuration (129.4--129.8 mm vs $\sim$70 mm for other methods). The results reveal consistent optimization behavior: all local gradient-free methods converge to nearly identical compact geometries (L = 69.5--70.9 mm) with coupling efficiencies within 2\% of each other in each medium. The systematic 8--10\% coupling improvement in argon over air for local methods perfectly matches the predicted 8.1\% atmospheric absorption loss, validating the atmospheric attenuation model.

The LA4148 + LA4022 configuration represents one of the highest-performing lens pairs identified in the systematic catalog screening, achieving both maximum coupling efficiency and compact system design ($L \approx$ 70 mm, nearly identical between media). Bayesian optimization was not evaluated in the analyze mode due to computational resource constraints. The consistent performance across all local optimization methods reflects the improved optimization landscape under the cooling jacket constraint (z$_1$ $\geq$ 27 mm), which eliminates certain classes of local minima present in unconstrained systems. However, grid search fails in both media, converging to suboptimal configurations with impractically long system lengths.

\textbf{Key findings:}

\begin{itemize}[leftmargin=*]
    \item \textit{Differential evolution} achieves the highest argon coupling (0.27) and competitive air performance (0.24), with moderate computation time ($\sim$8--10~s per lens pair). It provides thorough global exploration when robustness is critical.
    
    \item \textit{Dual annealing} achieves strong argon performance (0.26) and competitive air coupling (0.24), though with longer computation time ($\sim$10.6~s per lens pair). It provides robust global optimization when computational resources permit.
    
    \item \textit{Powell's method and Nelder-Mead} provide fast convergence ($\sim$0.5--1~s per lens pair) with consistent performance in both media (air: 0.24, argon: 0.26), making them highly efficient for rapid optimization. Powell's combination of speed and consistent performance makes it the recommended default for batch processing of large lens catalogs.
    
    \item \textit{Grid search} fails in both media: poor performance in air (0.17) and argon (0.21), converging to an impractically long configuration ($\sim$130 mm vs $\sim$70 mm for other methods). This suggests grid search samples poorly-positioned local minima in the optimization landscape.
    
    \item \textit{Method consistency:} All local optimization methods (differential evolution, dual annealing, Nelder-Mead, Powell) converge to nearly identical compact geometries ($L \approx$ 70 mm) with coupling efficiencies within 2\% in each medium. Grid search consistently fails to find these superior solutions.
    
    \item \textit{Method ranking:} Differential evolution achieves the best results in both media, followed closely by dual annealing and local methods. Grid search performs poorly regardless of medium.
    
    \item \textit{Medium comparison:} Argon provides measurable coupling improvement over air: 8--10\% relative improvement for this configuration across all local optimization methods (e.g., differential evolution: argon 0.27 vs air 0.24, 10\% improvement; Powell's method: argon 0.26 vs air 0.24, 8\% improvement). This improvement closely matches the predicted 8.1\% atmospheric absorption loss over the $\sim$70 mm beam path at 220 nm, validating the atmospheric attenuation model. Optimal system geometries are nearly identical between media ($\Delta L < 1$ mm), indicating absorption rather than dispersion dominates the medium-dependent performance.
\end{itemize}

\subsection{Multi-Objective Optimization Results}

The weighted objective function with tunable parameter $\alpha$ enables exploration of the coupling-compactness trade-off. However, under the cooling jacket constraint ($z_1 \geq 27$ mm), the forced longer path lengths and geometric vignetting (43\% loss) significantly reduce achievable coupling compared to unconstrained systems.

Representative results are presented in Table~\ref{tab:optimization_comparison} for the LA4148 + LA4022 lens pair ($f_1 = 50.2$ mm, $f_2 = 60$ mm), which represents one of the highest-performing configurations under cooling jacket constraints. At 220 nm with $\alpha = 0.7$ (balanced, default), the system achieves coupling efficiency $\eta = 0.24$ in air and $\eta = 0.26$--0.27 in argon, with system length $L \approx$ 70 mm for all local optimization methods (grid search fails, converging to impractically long configurations).

The choice of optimization method produces highly consistent results under cooling jacket constraints: all gradient-free local methods converge to nearly identical geometries ($L \approx$ 70~mm) with coupling efficiencies within 2\% in each medium. Differential evolution achieves the highest argon coupling (0.27) with moderate computation time (~8-10 seconds per lens pair). Powell's method and Nelder-Mead provide efficient alternatives (air: 0.24, argon: 0.26) with sub-second runtimes, making them ideal for batch processing.

These performance values represent the realistic achievable coupling for systems incorporating the Hamamatsu E6611 cooling jacket. The constraint $z_1 \geq 27$ mm forces the first lens to be positioned significantly farther from the source than optimal, resulting in lower coupling compared to unconstrained configurations. The extended optical path lengths ($L \approx$ 70 mm) amplify atmospheric absorption losses in air. At 220 nm, argon provides 8--10\% coupling improvement over air, closely matching the predicted 8.1\% atmospheric O$_2$ absorption loss over the beam path. This validates the atmospheric attenuation model and confirms that air operation incurs a measurable but potentially acceptable performance penalty at 220 nm.

\subsection{Lens Selection Analysis}

Analysis of high-performing configurations across multiple lens pair evaluations at 220 nm with cooling jacket constraints reveals consistent design principles:

\textbf{Argon propagation at 220 nm (best configurations from systematic optimization):}
\begin{itemize}[leftmargin=*]
    \item \textit{Highest coupling}: LA4148 + LA4022 achieved $\eta = 0.27$ with $L = 70.9$~mm ($f_1 = 50.2$ mm, $f_2 = 60$ mm)
    
    \item \textit{Note}: The LA4148 + LA4022 configuration represents the experimentally implemented design, selected for practical construction considerations and commercial availability.
\end{itemize}

\textbf{Air propagation at 220 nm (representative configurations from systematic optimization):}
\begin{itemize}[leftmargin=*]
    \item \textit{Best observed}: LA4148 + LA4022 achieved $\eta = 0.24$ with $L = 70.3$~mm ($f_1 = 50.2$ mm, $f_2 = 60$ mm)
    
    \item \textit{Note}: At 220 nm, air coupling is approximately 8--10\% lower than argon, closely matching the predicted 8.1\% atmospheric O$_2$ absorption loss over the $\sim$70 mm beam path.
\end{itemize}

\textbf{Lens type distribution:} The optimization framework supports plano-convex, bi-convex, and aspheric lens geometries (156, 2, and 44 lenses respectively in the evaluated catalog). All top-performing configurations under cooling jacket constraints utilize plano-convex lenses. This reflects both the dominant commercial availability of plano-convex designs in VUV-grade catalogs and their favorable balance of aberration control, cost-effectiveness, and optical throughput for the source-fiber geometry tested. The framework's multi-geometry capability enables straightforward evaluation of alternative lens types as new catalog entries become available.

\textbf{General design principles identified:}
\begin{itemize}[leftmargin=*]
    \item \textit{Focal length selection}: Pairs with $f_1 \approx 50$ mm and $f_2 \approx 60$ mm dominate the top performers, with focal length ratio $f_2/f_1 \approx 1.2$ providing optimal relay magnification for this source-fiber geometry under cooling jacket constraints
    
    \item \textit{First lens position}: Optimal $z_1$ is constrained to 27~mm (cooling jacket exit), with best configurations positioning L1 at or just beyond this minimum distance. The forced spacing allows substantial beam expansion before the first lens, which proves beneficial for coupling efficiency despite the geometric loss from source vignetting
    
    \item \textit{System length}: Best configurations achieve $L \approx$ 70~mm, substantially longer than unconstrained systems due to the cooling jacket constraint. This extended length contributes to increased atmospheric absorption losses in air
    
    \item \textit{Medium independence of geometry}: Optimal lens positions differ by less than 1~mm between air and argon, indicating that system geometry is primarily determined by ray optics rather than medium refractive index (both $n \approx 1.0003$). The primary medium-dependent effect is absorption rather than refraction
    
    \item \textit{Cooling jacket impact}: The constraint $z_1 \geq 27$ mm reduces achievable coupling by approximately 40\% compared to unconstrained optimization, but represents the realistic operational requirement for the Hamamatsu L7685/E6611 lamp assembly
\end{itemize}

\subsection{Propagation Medium Effects}

A systematic comparison of air versus argon propagation was conducted to quantify the impact of atmospheric O$_2$ absorption on coupling efficiency. At 220 nm, oxygen exhibits strong VUV absorption ($\sigma_{\text{O}_2} \approx 1.15 \times 10^{-20}$ cm$^2$, $\alpha_{\text{air}} \approx 0.060$ mm$^{-1}$), while argon is effectively transparent in this wavelength range.

Analysis of representative lens pairs optimized with cooling jacket constraints and evaluated in both media at 220 nm using Powell's method reveals measurable performance differences:

\begin{table}[h]
\centering
\caption{Air vs Argon Coupling Comparison (220 nm, with cooling jacket constraint) for Lens Pair LA4148 + LA4022}
\label{tab:air_vs_argon_220nm}
\small
\begin{tabular}{lccc}
\hline
\textbf{Method} & \textbf{Air $\bm{\eta}$} & \textbf{Argon $\bm{\eta}$} & \textbf{$\bm{\Delta\eta}$ (\%)} \\
\hline
Diff. Evol. & 0.24 & 0.27 & +10\% \\
Dual Anneal. & 0.24 & 0.26 & +9\% \\
Nelder-Mead & 0.24 & 0.26 & +8\% \\
Powell & 0.24 & 0.26 & +8\% \\
Average & 0.24 & 0.265 & +9\% \\
\hline
\end{tabular}
\end{table}

% FIGURE 3: Air vs Argon Medium Comparison for Wavelength 150-300 nm
\begin{figure*}[htpb]
    \centering
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=0.95\textwidth]{LA4148+LA4022_air_coupling_vs_wavelength_spline.png}
        \caption{Medium: Air}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=0.95\textwidth]{LA4148+LA4022_argon_coupling_vs_wavelength_spline.png}
        \caption{Medium: Argon}
    \end{subfigure}
    \caption{Coupling efficiency comparison across six optimization methods for lens pair LA4148+LA4022 across wavelength range 180-260 nm. The analysis uses fixed geometries calibrated at 220 nm. Results validate wavelength-dependent refractive index modeling and show chromatic performance characteristics of the system.}
    \label{fig:algorithm_comparison}
\end{figure*}

\textbf{Key observations:}
\begin{itemize}[leftmargin=*]
    \item \textit{Argon provides measurable coupling efficiency improvement} over air at 220 nm, with consistent performance across optimization methods. The improvement ranges from +8\% to +10\% for the LA4148+LA4022 configuration, averaging $\sim$9\% across all local optimization methods under cooling jacket constraints. This improvement closely matches the predicted 8.1\% atmospheric O$_2$ absorption loss over the $\sim$70 mm beam path.
    
    \item \textit{Method-independent medium effects}: The relative 8--10\% argon improvement is remarkably consistent across all local optimization algorithms (differential evolution, dual annealing, Nelder-Mead, Powell), indicating that the absorption loss is the dominant medium-dependent effect rather than optimization landscape artifacts.
    
    \item \textit{System length shows minimal medium dependence}: Optimal geometries differ by less than 1 mm between air and argon, confirming that system geometry is primarily determined by ray optics rather than medium refractive index (both $n \approx 1.0003$). The coupling difference arises almost entirely from absorption rather than dispersion.
    
    \item \textit{Physics validation}: The observed 8--10\% coupling improvement in argon precisely matches the Beer-Lambert absorption prediction: with attenuation coefficient $\alpha = 0.001207$ mm$^{-1}$ for air at 220 nm and path length $L \approx 70$ mm, the predicted transmission is $e^{-\alpha L} \approx 91.9\%$ (8.1\% loss). This agreement validates both the atmospheric attenuation model and the simulation accuracy.
\end{itemize}

\textbf{Practical implications:}

For applications requiring maximum coupling efficiency, argon purging provides a measurable 8--10\% improvement at 220 nm. Whether this improvement justifies the experimental complexity depends on application requirements:

Argon is recommended when:
\begin{itemize}[leftmargin=*]
    \item Maximum coupling efficiency is critical
    \item The 8--10\% improvement is significant for signal-to-noise ratio
    \item Infrastructure for gas purging is already available
    \item Sealed enclosure operation is acceptable
\end{itemize}

Air is acceptable when:
\begin{itemize}[leftmargin=*]
    \item Experimental simplicity is prioritized
    \item The 8--10\% coupling reduction is tolerable for the application
    \item Absolute coupling of 0.24 is sufficient
    \item Open-beam optical alignment and adjustments are required
\end{itemize}

The choice between air and argon at 220 nm represents a trade-off between performance and practicality. For cooling-jacket-constrained systems at 220 nm, air coupling of 0.24 versus argon coupling of 0.26--0.27 indicates that atmospheric absorption remains a measurable factor (8--10\% penalty), but the absolute performance in air may be sufficient for many applications. This makes air propagation viable for VUV applications at 220 nm when the performance penalty is acceptable, while argon remains the preferred choice for maximizing coupling efficiency.

\subsection{Wavelength Dependence Analysis}

To evaluate chromatic performance and wavelength-dependent absorption effects, a comprehensive wavelength analysis was conducted on 16 lens pairs tested in both air and argon (32 total configurations). Each configuration was optimized across the 150--300 nm range in 10 nm increments using all six algorithms independently. Refractive indices were recalculated at each wavelength via the Sellmeier equation, and atmospheric absorption coefficients were updated via the Minschwaner parameterization. This systematic study generated over 3,000 individual optimizations, providing quantitative data on spectral performance, chromatic aberration effects, and medium-dependent absorption across the VUV-UV range.

\subsubsection{Chromatic Aberration and the 200nm Calibration Strategy}

The wavelength analysis methodology employs a \textit{fixed-geometry strategy}: lens positions are optimized at 220 nm, then held constant while evaluating performance across the full 150--300 nm range. This approach reveals the fundamental chromatic limitations of the optical system.

Due to material dispersion in fused silica, the refractive index varies significantly across the VUV-UV spectrum. Using the Sellmeier equation (Eq.~4), representative values are:

\begin{center}
\begin{tabular}{cccc}
\hline
$\lambda$ (nm) & $n_{\text{glass}}$ & $\Delta n$ & $\Delta f/f$ \\
\hline
150 & 1.703 & +9.8\% & $-22\%$ \\
180 & 1.585 & +2.2\% & $-6\%$ \\
200 & 1.551 & 0\% & 0\% \\
220 & 1.528 & $-1.4\%$ & $+4\%$ \\
250 & 1.507 & $-2.8\%$ & $+9\%$ \\
300 & 1.488 & $-4.0\%$ & $+13\%$ \\
\hline
\end{tabular}
\end{center}

For a thin spherical lens with radius of curvature $R$, the thin-lens focal length follows:
\begin{equation}
f = \frac{R}{n_{\text{rel}} - 1}, \quad n_{\text{rel}} = \frac{n_{\text{glass}}(\lambda)}{n_{\text{medium}}(\lambda)}
\end{equation}

Since $n_{\text{medium}} \approx 1.0003$ for both air and argon in the VUV range, the relative index $n_{\text{rel}}$ varies almost entirely due to glass dispersion. A representative 25 mm radius spherical lens exhibits focal length variation from 35.6 mm at 150 nm to 51.3 mm at 300 nm---a 44\% change across the analysis range.

\textbf{Physical consequences}: When lens positions are optimized at 220 nm and then fixed:

\begin{itemize}[leftmargin=*]
    \item \textit{At 220 nm}: Focal planes align precisely with fiber entrance, maximizing coupling.
    
    \item \textit{At shorter wavelengths} ($\lambda < 200$ nm): Higher refractive index produces shorter focal length. With fixed lens positions, the beam focuses \textit{before} reaching the fiber face, arriving defocused with reduced coupling efficiency.
    
    \item \textit{At longer wavelengths} ($\lambda > 200$ nm): Lower refractive index produces longer focal length. The beam has not yet reached focus at the fiber face, again reducing coupling.
\end{itemize}

This chromatic aberration manifests as a \textit{peak in coupling efficiency at the calibration wavelength} (220 nm), with degraded performance at wavelengths farther from the design point. The observed coupling peak at 220 nm in Figure~3 is therefore not experimental artifact but physically correct behavior: the fixed optical geometry is inherently optimized only for the calibration wavelength.

\textbf{Implementation note}: Accurate wavelength-dependent simulation requires that lens refractive indices update dynamically. The lens classes (\texttt{PlanoConvex}, \texttt{BiConvex}, \texttt{Aspheric}) implement $n_{\text{glass}}$ as a computed property rather than a static constant:

\begin{verbatim}
@property
def n_glass(self):
    return fused_silica_n(WAVELENGTH_NM)
\end{verbatim}

This ensures that when the wavelength analysis function updates the global wavelength parameter, all lens objects automatically recalculate their refractive indices, correctly modeling chromatic effects. An earlier implementation using a module-level constant \texttt{N\_GLASS} frozen at import time produced unphysical results (constant coupling across all wavelengths), which was corrected in November 2025.

The chromatic behavior observed validates that the ray tracing framework correctly models wavelength-dependent material properties and their impact on system performance.



\textbf{Important methodological note:} The wavelength analysis results presented in this section use the LA4148+LA4022 configuration with fixed geometries calibrated at 220 nm. The coupling values reflect performance across the 180--260 nm range for this specific lens pair, providing insight into chromatic aberration effects and wavelength-dependent absorption in both air and argon media.

\textbf{Coupling vs wavelength characteristics (LA4148+LA4022, calibrated at 220 nm):}

\begin{itemize}[leftmargin=*]
    \item \textit{Below 180 nm (deep VUV)}: Severe coupling degradation in air due to extremely strong O$_2$ absorption. Argon maintains significantly better coupling, enabling deep-UV applications where air propagation becomes impractical.
    
    \item \textit{180--220 nm}: Rapid coupling recovery as O$_2$ absorption coefficient decreases. This transition defines the practical short-wavelength limit for air-filled systems at 220 nm and above.
    
    \item \textit{200--260 nm (plateau region)}: Peak coupling efficiency zone. Performance is relatively insensitive to wavelength in this range, indicating broad spectral tolerance. The LA4148+LA4022 configuration maintains good chromatic correction across this range despite material dispersion effects.
    
    \item \textit{Note on absolute values}: The LA4148+LA4022 wavelength analysis provides chromatic performance data for this specific configuration. Results show the expected wavelength-dependent behavior driven by fused silica dispersion and atmospheric absorption effects.
\end{itemize}

\textbf{Optimal operating wavelength:} The system achieves peak performance in the 200--240 nm range, where coupling is maximized and relatively flat. The design wavelength of 220 nm represents an appropriate choice for VUV applications, balancing material transmission, atmospheric absorption, and practical lamp emission characteristics.

\textbf{Medium selection by wavelength:}
\begin{itemize}[leftmargin=*]
    \item \textit{$\lambda < 180$ nm}: Argon essential (air coupling effectively zero due to severe O$_2$ absorption)
    \item \textit{180--200 nm}: Argon strongly recommended (substantial absorption reduction)
    \item \textit{200--260 nm}: Argon provides 8--10\% improvement at 220 nm for LA4148+LA4022; air viable when performance penalty acceptable
    \item \textit{$\lambda > 260$ nm}: Air acceptable (minimal absorption effects)
\end{itemize}

Detailed wavelength-dependent coupling data for the LA4148+LA4022 configuration in both air and argon, including results from all five optimization methods (excluding Bayesian), are archived in \path{results/wavelength_analyze_2026-01-21/}. These data enable design optimization for specific wavelength requirements, provide validation for chromatic aberration models, and inform algorithm selection for wavelength-specific applications.

\subsection{Alignment Tolerance Analysis}

Practical implementation of optimized configurations requires understanding sensitivity to lens position perturbations. Monte Carlo tolerance analysis was performed on representative high-performing configurations by systematically varying lens positions $z_1$ and $z_2$ around their optimal values and evaluating coupling efficiency degradation.

% FIGURE 4: Tolerance Analysis for Configuration 36-686 + 48-273 (Unconstrained)
\begin{figure*}[htpb]
    \centering
    \includegraphics[width=0.8\textwidth]{images/tolerance_LA4148+LA4022.png}
    \caption{Coupling efficiency sensitivity to lens position perturbations for configuration LA4148+LA4022 in argon at 220 nm (cooling-jacket-constrained geometry). Contour plot shows coupling as a function of $\Delta z_1$ and $\Delta z_2$ displacements from optimal positions ($z_1^* = 27.05$ mm, $z_2^* = 33.69$ mm). The steep gradients near the optimum indicate tight alignment tolerances: $\pm$0.5 mm displacement causes $\sim$15--20\% coupling degradation. Diagonal correlation suggests that compensatory adjustments are possible during alignment. This analysis reflects the experimentally implemented configuration under cooling jacket constraints.}
    \label{fig:tolerance_analysis}
\end{figure*}

Key findings from cooling-jacket-constrained tolerance analysis: (1) Both lens positions require sub-millimeter alignment precision to maintain $>$90\% of optimal coupling. (2) Fiber position ($z_{\text{fiber}}$) shows similar sensitivity. (3) The LA4148+LA4022 configuration exhibits moderate tolerance characteristics, providing practical margin for laboratory implementation despite the forced longer optical path. (4) Angular misalignment tolerance (not shown) is expected to be similar to unconstrained systems, requiring $<$2$^\circ$ tilt tolerance. These results establish realistic alignment requirements for the experimental prototype with cooling jacket constraints.

\subsection{Computational Efficiency}

Typical execution times per lens pair on standard hardware (Intel Core i7, single-threaded), measured from January 2026 analyze runs:

\begin{itemize}[leftmargin=*]
    \item \textbf{Powell's method}: 0.5 seconds (recommended for routine optimization, excellent balance of speed and performance)
    \item \textbf{Nelder-Mead}: 0.5 seconds (fast convergence with strong performance)
    \item \textbf{Grid search}: 0.5--0.6 seconds (with default 7$\times$7 grid, systematic baseline)
    \item \textbf{Differential evolution}: 2--3 seconds (thorough global search)
    \item \textbf{Dual annealing}: 10--12 seconds (effective global optimization, escapes local minima)
    \item \textbf{Bayesian optimization}: not measured in recent runs (sample-efficient, requires scikit-optimize)
\end{itemize}

For a complete \texttt{select} mode scan (3,876 lens combinations):
\begin{itemize}[leftmargin=*]
    \item Powell's method: $\sim$32 minutes (0.5 s/pair $\times$ 3,876)
    \item Differential evolution: $\sim$3.2 hours (3 s/pair $\times$ 3,876)
    \item Grid search: $\sim$3.2 hours (3 s/pair $\times$ 3,876)
\end{itemize}

For exhaustive \texttt{combine} mode (24,336 combinations):
\begin{itemize}[leftmargin=*]
    \item Powell's method: $\sim$14 hours
    \item Differential evolution: $\sim$115 hours ($\sim$5 days)
\end{itemize}

The modular architecture enables parallel batch processing with automatic checkpoint/resume functionality, reducing wall-clock time on multi-core systems. Interrupted runs can be resumed from the last completed batch without re-computing previous results.

\section{Conclusions}

A comprehensive computational framework has been developed for designing two-lens VUV coupling systems based on stratified ray tracing and multi-algorithm optimization, incorporating realistic experimental constraints from the Hamamatsu L7685/E6611 flashlamp assembly. The methodology accurately models finite aperture effects, large ray angles, realistic fiber acceptance criteria, cooling jacket geometric constraints, and atmospheric absorption at 220 nm without relying on paraxial approximations.

\textbf{The Hamamatsu E6611 cooling jacket imposes critical design constraints}: lens positioning constrained to z $\geq$ 27 mm (vs 9.7 mm without cooling jacket), angular acceptance limited to 22.85$^\circ$, and 43\% geometric vignetting loss from solid angle reduction. These constraints fundamentally reshape the optimization landscape, forcing longer optical paths (L $\approx$ 93 mm vs $\sim$56 mm for unconstrained systems) and reducing achievable coupling efficiency by approximately 40\% compared to idealized configurations. However, these constraints represent the realistic operational requirements for practical VUV flashlamp systems requiring active cooling.

Systematic comparison of six optimization algorithms under cooling jacket constraints reveals that \textbf{Powell's method and Nelder-Mead} provide excellent balance of performance and speed, achieving strong coupling efficiencies with sub-second convergence. For applications requiring thorough global exploration, \textbf{differential evolution} provides robust performance with the highest argon coupling results at moderate computational cost (8--10 seconds per lens pair). Dual annealing achieves competitive performance with longer computation time (10.6 seconds per lens pair). Grid search fails in both media, converging to impractically long configurations with poor coupling. All gradient-free local methods converge to nearly identical solutions (within 2\% coupling variation in each medium, $L \approx$ 70 mm) under the cooling jacket constraint.

The multi-objective framework successfully navigates the coupling-compactness trade-off through the tunable $\alpha$ parameter. Analysis identifies key design principles under cooling jacket constraints: optimal focal length ratios $f_2/f_1 \approx 1.2$ (specifically $f_1 \approx 50$ mm, $f_2 \approx 60$ mm), first lens positioning at the minimum clearance distance (z$_1$ = 27 mm), and optical system lengths (first lens to fiber) $L \approx$ 70 mm.

\textbf{Atmospheric absorption at 220 nm}, modeled using the Minschwaner O$_2$ cross-section parameterization, represents a measurable performance factor at this wavelength. Systematic comparison of air versus argon propagation reveals a \textbf{consistent 8--10\% coupling improvement in argon} across all local optimization methods for the LA4148+LA4022 lens pair. For this high-performing configuration under cooling jacket constraints, coupling efficiency reaches $\eta = 0.24$ in air and $\eta = 0.26$--0.27 in argon at 220 nm, with system lengths $L \approx$ 70 mm nearly identical between media ($\Delta L < 1$ mm). The observed improvement closely matches the predicted 8.1\% atmospheric O$_2$ absorption loss over the $\sim$70 mm beam path, validating both the atmospheric attenuation model and simulation accuracy. This indicates that \textbf{air propagation is viable at 220 nm when the 8--10\% coupling penalty is acceptable}, while \textbf{argon remains preferred for maximum coupling efficiency}.

\textbf{Wavelength dependence analysis} (150--300 nm) reveals critical spectral characteristics and validates chromatic modeling. The wavelength analysis methodology employs fixed lens geometries optimized at 220 nm, then evaluates performance across the wavelength range. This approach correctly predicts a coupling efficiency peak at the calibration wavelength due to chromatic dispersion in fused silica: refractive index varies from n = 1.703 at 150 nm to n = 1.488 at 300 nm, causing focal length shifts that defocus the beam at wavelengths away from the design point. Air becomes impractical below 180 nm due to extreme O$_2$ absorption, requiring argon for deep-UV applications. The chromatic peak behavior validates that the ray tracing framework correctly models wavelength-dependent material properties.

Achieved coupling efficiencies of 0.24 (air) and 0.26--0.27 (argon) at 220 nm represent realistic predictions for laboratory systems incorporating cooling jacket constraints. These values are lower than unconstrained idealized systems due to the 43\% geometric vignetting loss imposed by the M23 cooling jacket aperture. Experimental realization will require additional consideration of: (1) Fresnel reflection losses ($\sim$5\% per surface, $\sim$20\% total for 4 surfaces), (2) bulk absorption in UV optics, (3) alignment tolerances, and (4) actual arc lamp spatial and angular emission distributions. Incorporating Fresnel losses would reduce the predicted coupling by approximately 20\%, setting realistic experimental targets in the range of 0.19 (air) to 0.21--0.22 (argon) for systems at 220 nm.

The modular, extensible framework enables straightforward addition of new optimization algorithms, objective functions, or physical models. The absorption model is implemented in \path{scripts/calcs.py} and \path{scripts/hitran_data.py} using empirical cross-section parameterizations. Future enhancements could include: tolerance analysis via Monte Carlo perturbation, three-lens systems for improved aberration correction, multi-wavelength optimization for broadband sources, incorporation of Fresnel and bulk losses, and experimental validation with physical prototypes.

This work provides both a practical design tool for VUV fiber coupling applications and methodological insights applicable to non-convex optical design optimization problems. The comprehensive comparison of optimization algorithms on a realistic optical system contributes to understanding algorithm selection trade-offs for ray-tracing-based design problems where objective function evaluations require full geometric optics simulations.


\bibliographystyle{unsrt}
\bibliography{references}

\end{document}
